<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gdarchivio online</title>
    <link rel="icon" type="image/png" href="https://placehold.co/32x32/000000/FFFFFF/png?text=GD" />

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bitcount+Single&family=Martian+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Martian Mono', monospace; background-color: #ffffff; color: #000000; }
        ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: #f1f1f1; } ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; } ::-webkit-scrollbar-thumb:hover { background: #555; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        .font-bitcount-single { font-family: 'Bitcount Single', monospace; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { 
              'martian-mono': ['"Martian Mono"', 'monospace'], 
              'bitcount-single': ['"Bitcount Single"', 'monospace'], 
            },
            colors: { 
              'dark-gray': '#333333', 
              'cold-gray': '#888888', 
            }
          }
        }
      };
    </script>
</head>
<body class="antialiased">
    <noscript>Per visualizzare questa applicazione, è necessario abilitare JavaScript.</noscript>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <script>
    window.addEventListener('load', runApp);

    function runApp() {
        if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
            console.error('React o ReactDOM non sono stati caricati.');
            return;
        }

        const { useState, useEffect, useMemo, useCallback, Fragment, useRef } = React;
        const { createRoot } = ReactDOM;
        const e = React.createElement;

        // ==========================================================
        // DATI MOCK E COSTANTI
        // ==========================================================
        const getPlaceholderImageUrl = (width, height, text) => `https://placehold.co/${width}x${height}/f0f0f0/333?text=${encodeURIComponent(text)}`;
        
        const generateProducts = (count, type) => {
            const sample = {
                brands: type === 'product' ? ['Miss Sixty', 'Diesel', 'Blumarine', 'Prada', 'Gucci', 'Jean Paul Gaultier', 'Versace'] : ['Dolce & Gabbana', 'Prada', 'Helmut Lang', 'Maison Martin Margiela', 'Thierry Mugler', 'Comme des Garçons'],
                categories: ['jackets', 'pants', 'top', 'dresses', 'bags', 'skirts', 'shoes'],
                colors: ['black', 'blue', 'white', 'multicolour', 'brown', 'red', 'pink'],
                names: {jackets: 'Jacket', pants: 'Trousers', top: 'Top', dresses: 'Dress', bags: 'Bag', skirts: 'Skirt', shoes: 'Heels'}
            };
            const products = [];
            for (let i = 0; i < count; i++) {
                const category = sample.categories[i % sample.categories.length];
                const brand = sample.brands[i % sample.brands.length];
                const product = {
                    id: `${type === 'product' ? 100 : 0}${i + 1}`,
                    name: `${sample.names[category]}`,
                    brand: brand,
                    category: category,
                    color: sample.colors[i % sample.colors.length],
                    size: ['S', 'M', 'L', 'one size'][i % 4],
                    year: 2010 - (i % 24),
                    images: [getPlaceholderImageUrl(800, 1000, `${brand} ${i+1}`)],
                    description: `Descrizione del prodotto ${brand} ${sample.names[category]}.`,
                    condition: 'Very Good',
                    material: 'Varies',
                    measurements: { chest: '50cm', length: '70cm'},
                    type: type,
                };
                if (type === 'product') {
                    product.purchaseLinks = { VINTED: 'https://www.vinted.it/', 'VESTIAIRE COLLECTIVE': 'https://www.vestiairecollective.com/' };
                }
                products.push(product);
            }
            return products;
        };

        const mockProducts = [...generateProducts(20, 'product'), ...generateProducts(20, 'archive')];

        const mockLibraryItems = [
          { id: 'L1', name: 'Fashion History', author: 'Jane Doe', publisher: 'Fashion Books Inc.', year: 2015, category: 'history', images: [getPlaceholderImageUrl(800, 1000, 'Book 1')], description: 'A comprehensive guide to the history of fashion.', type: 'book', measurements:{} },
          { id: 'L2', name: 'The Art of Dressmaking', author: 'John Smith', publisher: 'Craft Publications', year: 2008, category: 'craft', images: [getPlaceholderImageUrl(800, 1000, 'Book 2')], description: 'Techniques and tips for haute couture.', type: 'book', measurements:{} },
          { id: 'L3', name: 'Savage Beauty', author: 'Andrew Bolton', publisher: 'Metropolitan Museum', year: 2011, category: 'biography', images: [getPlaceholderImageUrl(800, 1000, 'Book 3')], description: 'An exploration of McQueen\'s iconic work.', type: 'book', measurements:{} },
        ];

        const filterOptions = {
            collection: {
                brand: ['Alexander McQueen', 'Ann Demeulemeester', 'Blumarine', 'Christian Dior', 'Comme des Garçons', 'D&G', 'Diesel', 'Dolce & Gabbana', 'Emilio Pucci', 'Faycal Amor', 'Gianni Versace', 'Gucci', 'Helmut Lang', 'Jean Paul Gaultier', 'John Galliano', 'MM6', 'Maison Martin Margiela', 'Marité Francois Girbaud', 'Miss Sixty', 'Miu Miu', 'Plein Sud', 'Prada', 'Roberto Cavalli', 'Thierry Mugler', 'Versace', 'Vivienne Westwood'],
                category: ['accessories', 'bags', 'dresses', 'jackets', 'pants', 'set', 'shoes', 'skirts', 'top'],
                color: ['black', 'blue', 'brown', 'burgundy', 'gold', 'grey', 'khaki', 'multicolour', 'white', 'red', 'yellow', 'orange', 'silver', 'pink'],
                size: ['XL', 'L', 'M', 'S', 'XS', '35', '36', '37', '38', '39', '40', '41', '42', '43', 'one size'],
                year: Array.from({length: 2010 - 1987 + 1}, (_, i) => 2010 - i),
            },
            archive: {
                brand: ['Azzedine Alaïa', 'Alexander McQueen', 'Ann Demeulemeester', 'Christian Dior', 'Comme des Garçons', 'D&G', 'Dolce & Gabbana', 'Faycal Amor', 'Gianni Versace', 'Gucci', 'Helmut Lang', 'Jean Paul Gaultier', 'John Galliano', 'MM6', 'Maison Martin Margiela', 'Marité Francois Girbaud', 'Miss Sixty', 'Miu Miu', 'Plein Sud', 'Prada', 'Roberto Cavalli', 'Thierry Mugler', 'Versace', 'Vivienne Westwood'],
                category: ['accessories', 'bags', 'dresses', 'jackets', 'pants', 'set', 'shoes', 'skirts', 'top'],
                color: ['black', 'blue', 'brown', 'burgundy', 'gold', 'grey', 'khaki', 'multicolour', 'white', 'red', 'yellow', 'orange', 'silver', 'pink'],
                size: ['XL', 'L', 'M', 'S', 'XS', '35', '36', '37', '38', '39', '40', '41', '42', '43', 'one size'],
                year: Array.from({length: 2010 - 1987 + 1}, (_, i) => 2010 - i),
            },
            library: {
                author: ['Jane Doe', 'John Smith', 'Fashion Historian', 'Andrew Bolton'],
                category: ['history', 'craft', 'biography', 'photography'],
                year: Array.from({length: 2024 - 1980 + 1}, (_, i) => 2024 - i),
            }
        };

        const sortOptions = ['name a–z', 'name z–a', 'brand a-z', 'brand z-a', 'year old to new', 'year new to old'];
        
        // ==========================================================
        // COMPONENTI ICONA INLINE
        // ==========================================================
        const Icon = ({ name, size = 16, className = '' }) => {
            const iconProps = { xmlns: 'http://www.w3.org/2000/svg', width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round', className: className };
            const icons = {
                Search: e('svg', iconProps, e('circle', { cx: '11', cy: '11', r: '8' }), e('line', { x1: '21', y1: '21', x2: '16.65', y2: '16.65' })),
                ChevronDown: e('svg', iconProps, e('path', { d: 'm6 9 6 6 6-6' })),
                ArrowLeft: e('svg', iconProps, e('path', { d: 'm12 19-7-7 7-7' }), e('path', { d: 'M19 12H5' })),
                ExternalLink: e('svg', iconProps, e('path', { d: 'M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6' }), e('polyline', { points: '15 3 21 3 21 9' }), e('line', { x1: '10', y1: '14', x2: '21', y2: '3' })),
                X: e('svg', iconProps, e('line', { x1: '18', y1: '6', x2: '6', y2: '18' }), e('line', { x1: '6', y1: '6', x2: '18', y2: '18' })),
                FilterSliders: e('svg', {...iconProps, strokeWidth: 1.5, viewBox: '0 0 24 24'}, e('path', {d: 'M2 6h3m16 0h-9M5 6a2 2 0 0 0-4 0v0a2 2 0 0 0 4 0v0Zm10 6h3m-9 0H2m3 0a2 2 0 0 0-4 0v0a2 2 0 0 0 4 0v0Zm14 6h-3m-9 0H2m9 0a2 2 0 0 0-4 0v0a2 2 0 0 0 4 0v0Z'})),
                Menu: e('svg', iconProps, e('line', { x1: '3', y1: '12', x2: '21', y2: '12' }), e('line', { x1: '3', y1: '6', x2: '21', y2: '6' }), e('line', { x1: '3', y1: '18', x2: '21', y2: '18' })),
                Instagram: e('svg', iconProps, e('rect', { x: '2', y: '2', width: '20', height: '20', rx: '5', ry: '5' }), e('path', { d: 'M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z' }), e('line', { x1: '17.5', y1: '6.5', x2: '17.51', y2: '6.5' }))
            };
            return icons[name] || null;
        };

        // ==========================================================
        // COMPONENTE DROPDOWN PER FILTRI
        // ==========================================================
        const FilterDropdown = ({ label, values, isOpen, onToggle, selectedValues, onFilterChange }) => {
            return e('div', { className: 'relative' },
                e('button', {
                    onClick: onToggle,
                    className: 'flex items-center gap-2 font-martian-mono text-sm'
                },
                    label.toLowerCase(),
                    e(Icon, { name: 'ChevronDown', size: 14, className: `transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}` })
                ),
                isOpen && e('div', { className: 'absolute top-full left-0 mt-2 w-72 bg-white border rounded-lg shadow-xl animate-fade-in z-30' },
                    e('div', { className: 'max-h-80 overflow-y-auto p-2' },
                        values.map(option => e('label', {
                            key: option,
                            className: 'flex items-center w-full text-left px-4 py-2 font-martian-mono text-sm hover:bg-gray-100 cursor-pointer rounded-md'
                        },
                           e('input', { 
                               type: 'checkbox', 
                               className: 'hidden', 
                               checked: selectedValues.includes(String(option)),
                               onChange: () => onFilterChange(label, String(option))
                            }),
                           e('div', { className: `w-4 h-4 border border-gray-400 rounded-sm mr-3 flex-shrink-0 bg-white ${selectedValues.includes(String(option)) ? 'bg-black' : ''}` }),
                           String(option)
                        ))
                    )
                )
            );
        };

        // ==========================================================
        // COMPONENTI UI RIUTILIZZABILI
        // ==========================================================
        const Header = ({ navigateTo, currentRoute }) => {
            const [isMenuOpen, setIsMenuOpen] = useState(false);
            const navItems = [
                { label: 'Collection', page: '#collection' },
                { label: 'Archive', page: '#archive' },
                { label: 'Library', page: '#library' },
                { label: 'Contact', page: '#contact' }
            ];

            const navigateAndClose = (path) => {
                navigateTo(path);
                setIsMenuOpen(false);
            };

            return e(Fragment, null, 
                e('header', { className: 'sticky top-0 bg-white bg-opacity-80 backdrop-blur-sm border-b border-gray-200 z-20' },
                    e('div', { className: 'container mx-auto px-4 sm:px-6 lg:px-8' },
                        e('div', { className: 'flex items-center justify-between h-20' },
                            e('a', { href: '#home', onClick: (ev) => { ev.preventDefault(); navigateAndClose('#home'); }, className: 'flex items-center gap-3' },
                                e('div', { className: 'w-8 h-8 border border-black flex-shrink-0' }),
                                e('span', { className: 'font-bitcount-single text-4xl' }, 'gdarchivio')
                            ),
                            e('nav', { className: 'hidden md:flex md:items-center md:space-x-8' },
                                navItems.map(item => e('a', {
                                    key: item.label,
                                    href: item.page,
                                    onClick: (ev) => { ev.preventDefault(); navigateTo(item.page); },
                                    className: `font-martian-mono uppercase tracking-wider text-sm ${currentRoute.startsWith(item.page) ? 'font-bold' : 'font-normal'} hover:font-bold transition-all`
                                }, item.label))
                            ),
                             e('div', { className: 'hidden md:flex items-center' },
                                e('div', { className: 'relative' },
                                    e('input', { type: 'text', placeholder: 'Search...', className: 'border border-gray-300 rounded-full py-1.5 pl-4 pr-8 w-40 text-sm focus:outline-none focus:ring-1 focus:ring-black' }),
                                    e('div', { className: 'absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none' }, e(Icon, { name: 'Search', size: 16, className: 'text-gray-400' }))
                                )
                            ),
                            e('button', { className: 'md:hidden', onClick: () => setIsMenuOpen(!isMenuOpen) },
                                e(Icon, { name: isMenuOpen ? 'X' : 'Menu', size: 24 })
                            )
                        )
                    )
                ),
                isMenuOpen && e('div', { className: 'fixed inset-0 bg-white z-10 p-4 animate-fade-in md:hidden' },
                    e('nav', { className: 'flex flex-col items-center justify-center h-full space-y-8' },
                         navItems.map(item => e('a', {
                            key: item.label,
                            href: item.page,
                            onClick: (ev) => { ev.preventDefault(); navigateAndClose(item.page); },
                            className: 'font-martian-mono uppercase tracking-wider text-2xl'
                        }, item.label)),
                         e('div', { className: 'relative mt-8' },
                            e('input', { type: 'text', placeholder: 'Search...', className: 'border border-gray-300 rounded-full py-2 px-5 w-64 text-lg focus:outline-none focus:ring-1 focus:ring-black' }),
                            e('div', { className: 'absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none' }, e(Icon, { name: 'Search', size: 20, className: 'text-gray-400' }))
                        )
                    )
                )
            );
        };

        const Footer = () => {
             return e('footer', { className: 'bg-white' },
                e('div', { className: 'container mx-auto px-4 sm:px-6 lg:px-8' },
                    e('div', { className: 'py-12 text-left border-t border-gray-200' },
                        e('a', { href: '#home', className: 'flex items-center gap-3 mb-6' },
                             e('div', { className: 'w-8 h-8 border border-black flex-shrink-0' }),
                            e('span', { className: 'font-bitcount-single text-4xl' }, 'gdarchivio')
                        ),
                        e('p', { className: 'font-martian-mono text-sm text-dark-gray max-w-md' }, 'curated fashion archive. authentic pieces from the world\'s most iconic maisons.'),
                        e('a', {
                            href: 'https://instagram.com',
                            target: '_blank',
                            rel: 'noopener noreferrer',
                            className: 'font-martian-mono text-sm uppercase tracking-wider mt-6 inline-block hover:underline'
                        }, 'Instagram')
                    )
                ),
                e('div', { className: 'border-t border-gray-200' },
                    e('div', { className: 'container mx-auto px-4 sm:px-6 lg:px-8' },
                         e('p', { className: 'text-center font-martian-mono text-xs text-cold-gray py-8' }, '© 2025 GDARCHIVIO. ALL RIGHTS RESERVED.')
                    )
                )
            );
        };
        
        const FilterBar = ({ options, itemCount, selectedFilters, onFilterChange, onResetFilters }) => {
            const [openFilter, setOpenFilter] = useState(null);
            const barRef = useRef(null);

            const areFiltersActive = useMemo(() => {
                return Object.values(selectedFilters).some(arr => arr.length > 0);
            }, [selectedFilters]);

            useEffect(() => {
                const handleClickOutside = (event) => {
                    if (barRef.current && !barRef.current.contains(event.target)) {
                        setOpenFilter(null);
                    }
                };
                document.addEventListener("mousedown", handleClickOutside);
                return () => document.removeEventListener("mousedown", handleClickOutside);
            }, []);
            
            const handleToggle = (label) => {
                setOpenFilter(prev => (prev === label ? null : label));
            };

            const SortDropdown = () => e('div', { className: 'relative' },
                e('select', {className: 'font-martian-mono text-sm border border-black py-1 px-2 appearance-none pr-6 bg-white'},
                    sortOptions.map(opt => e('option', {key: opt, value: opt}, opt))
                )
            );

            return e('div', { className: 'sticky top-20 bg-white z-20 py-4 border-b border-gray-200 mb-8', ref: barRef },
                e('div', { className: 'container mx-auto px-4 sm:px-6 lg:px-8' },
                    e('div', { className: 'flex items-center justify-between' },
                        e('div', { className: 'flex items-center gap-x-4 flex-wrap' },
                            e(Icon, { name: 'FilterSliders', size: 20, className: 'text-cold-gray flex-shrink-0' }),
                            e('span', { className: 'font-martian-mono text-sm text-cold-gray uppercase flex-shrink-0' }, 'Filter:'),
                            Object.entries(options).map(([label, values]) => e(FilterDropdown, { 
                                key: label, 
                                label, 
                                values,
                                isOpen: openFilter === label,
                                onToggle: () => handleToggle(label),
                                selectedValues: selectedFilters[label] || [],
                                onFilterChange
                            })),
                            areFiltersActive && e('button', {
                                onClick: onResetFilters,
                                className: 'font-martian-mono text-sm text-cold-gray hover:text-black underline ml-4'
                            }, 'Reset filters')
                        ),
                        e('div', {className: 'hidden sm:block ml-4'}, e(SortDropdown))
                    ),
                    e('div', { className: 'mt-4' },
                        e('span', { className: 'font-martian-mono text-xs text-cold-gray' }, `${itemCount} items found`)
                    )
                )
            );
        };

        const ItemCard = ({ item, navigateTo, page }) => {
            const meta = [item.year, item.category, item.color, item.size].filter(Boolean).join(' • ');
            return e('div', {
                className: "group cursor-pointer flex flex-col",
                onClick: () => navigateTo(page, item)
            },
                e('div', { className: "aspect-[4/5] bg-gray-100 overflow-hidden" },
                    e('img', { src: item.images[0], alt: item.name, className: "w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" })
                ),
                e('div', { className: 'mt-3 text-left flex-grow' },
                    e('h3', { className: "font-martian-mono uppercase text-sm text-cold-gray" }, item.brand || item.author),
                    e('p', { className: "font-martian-mono uppercase font-bold text-sm text-black" }, item.name),
                    e('p', { className: "font-martian-mono text-xs text-cold-gray mt-1" }, meta)
                ),
                 item.type === 'product' && e('div', { className: 'mt-2 space-y-1' },
                    Object.entries(item.purchaseLinks).map(([platform, url]) => 
                        e('a', {
                            key: platform, href: url, target: '_blank', rel: 'noopener noreferrer',
                            onClick: (e) => e.stopPropagation(),
                            className: 'flex items-center gap-2 text-xs font-martian-mono text-cold-gray hover:text-black hover:underline'
                        },
                            e('span', null, platform),
                            e(Icon, { name: 'ExternalLink', size: 12 })
                        )
                    )
                 )
            );
        };
        
        const Modal = ({ isOpen, onClose, children, title }) => {
            if (!isOpen) return null;
            return e('div', { className: 'fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4', onClick: onClose },
                e('div', { className: 'bg-white p-8 relative w-full max-w-md animate-fade-in', onClick: e => e.stopPropagation() },
                    e('button', { onClick: onClose, className: 'absolute top-4 right-4 text-gray-400 hover:text-black' }, e(Icon, { name: 'X', size: 24 })),
                    title && e('h3', { className: 'font-martian-mono uppercase font-bold text-center text-lg mb-6' }, title),
                    children
                )
            );
        };
        
        const InquiryForm = () => e('form', null,
            e('div', { className: 'mb-4' },
                e('label', { htmlFor: 'modal-name', className: 'block font-martian-mono text-xs uppercase mb-1' }, 'Name'),
                e('input', { type: 'text', id: 'modal-name', className: 'w-full border border-black p-2 text-sm focus:outline-none focus:ring-1 focus:ring-black' })
            ),
            e('div', { className: 'mb-4' },
                e('label', { htmlFor: 'modal-email', className: 'block font-martian-mono text-xs uppercase mb-1' }, 'Email'),
                e('input', { type: 'email', id: 'modal-email', className: 'w-full border border-black p-2 text-sm focus:outline-none focus:ring-1 focus:ring-black' })
            ),
            e('div', { className: 'mb-4' },
                e('label', { htmlFor: 'modal-message', className: 'block font-martian-mono text-xs uppercase mb-1' }, 'Message'),
                e('textarea', { id: 'modal-message', rows: 4, className: 'w-full border border-black p-2 text-sm focus:outline-none focus:ring-1 focus:ring-black' })
            ),
            e('button', { type: 'submit', className: 'w-full bg-black text-white py-3 font-martian-mono uppercase tracking-wider text-sm hover:bg-dark-gray transition-colors' }, 'Send Message')
        );

        // ==========================================================
        // PAGINE
        // ==========================================================
        const HomePage = ({ navigateTo }) => {
            const NavCard = ({ imageSrc, title, caption, page }) => (
                e('div', { className: "group cursor-pointer text-center", onClick: () => navigateTo(page) },
                    e('div', { className: "aspect-[4/5] bg-gray-100 overflow-hidden mb-4" },
                        e('img', { src: imageSrc, alt: title, className: "w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" })
                    ),
                    e('h3', { className: "font-martian-mono font-bold uppercase tracking-wider text-sm sm:text-base" }, title),
                    e('p', { className: "font-martian-mono text-xs text-cold-gray tracking-widest" }, caption)
                )
            );
            
            return e('div', { className: "flex flex-col min-h-screen bg-white text-black" },
                e('main', { className: "flex-grow flex flex-col justify-center items-center p-4" },
                    e('header', { className: "text-center" },
                        e('h1', { className: "font-bitcount-single text-6xl md:text-7xl" }, "gdarchivio"),
                        e('p', { className: "font-martian-mono text-dark-gray tracking-widest mt-2" }, "fashion archive")
                    ),
                    e('nav', { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-8 my-10 sm:my-12 w-full max-w-sm md:max-w-4xl" },
                        e(NavCard, { imageSrc: getPlaceholderImageUrl(400, 500, "Collection"), title: "COLLECTION", caption: "curated pieces", page: "#collection" }),
                        e(NavCard, { imageSrc: getPlaceholderImageUrl(400, 500, "Archive"), title: "ARCHIVE", caption: "archive items", page: "#archive" }),
                        e(NavCard, { imageSrc: getPlaceholderImageUrl(400, 500, "Library"), title: "LIBRARY", caption: "fashion books", page: "#library" }),
                        e(NavCard, { imageSrc: getPlaceholderImageUrl(400, 500, "Contact"), title: "CONTACT", caption: "get in touch", page: "#contact" })
                    ),
                    e('button', { className: "font-martian-mono uppercase tracking-wider border border-black px-8 py-3 rounded-full hover:bg-gray-100 transition-colors text-sm", onClick: () => navigateTo('#collection') }, "ENTER COLLECTION")
                ),
                e('footer', { className: "w-full py-6 px-4" },
                    e('div', { className: "container mx-auto text-center" },
                        e('div', { className: "border-b border-gray-300 w-20 mx-auto mb-4" }),
                        e('p', { className: "font-martian-mono text-xs text-cold-gray uppercase tracking-widest" }, "ITALY • EST. 2025")
                    )
                )
            );
        };

        const ListPage = ({ items, navigateTo, page, options }) => {
            const initialFilters = useMemo(() => Object.keys(options).reduce((acc, key) => ({ ...acc, [key]: [] }), {}), [options]);
            const [selectedFilters, setSelectedFilters] = useState(initialFilters);

            const handleFilterChange = useCallback((filterType, value) => {
                setSelectedFilters(prevFilters => {
                    const currentValues = prevFilters[filterType] || [];
                    const newValues = currentValues.includes(value)
                        ? currentValues.filter(v => v !== value)
                        : [...currentValues, value];
                    return { ...prevFilters, [filterType]: newValues };
                });
            }, []);
            
            const handleResetFilters = useCallback(() => {
                setSelectedFilters(initialFilters);
            }, [initialFilters]);
            
            const filteredItems = useMemo(() => {
                return items.filter(item => {
                    return Object.entries(selectedFilters).every(([key, values]) => {
                        if (values.length === 0) return true;
                        return values.includes(String(item[key]));
                    });
                });
            }, [items, selectedFilters]);

            return e(Fragment, null,
                e(FilterBar, { 
                    options, 
                    itemCount: filteredItems.length, 
                    selectedFilters, 
                    onFilterChange: handleFilterChange,
                    onResetFilters: handleResetFilters
                }),
                e('main', { className: 'container mx-auto px-4 sm:px-6 lg:px-8 py-8' },
                    e('a', { 
                        href: '#home', 
                        onClick: (ev) => { ev.preventDefault(); navigateTo('#home'); },
                        className: 'flex items-center gap-2 font-martian-mono text-sm uppercase text-cold-gray hover:text-black mb-6' 
                    }, e(Icon, { name: 'ArrowLeft', size: 16 }), 'Back'),
                    e('div', { className: 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-10' },
                        filteredItems.map(item => e(ItemCard, { key: item.id, item, navigateTo, page }))
                    )
                )
            );
        };
        
        const DetailPage = ({ item, navigateTo }) => {
            const [modal, setModal] = useState(null);
            const [mainImage, setMainImage] = useState(item.images[0]);
            
            const goBackUrl = `#${item.type === 'book' ? 'library' : (item.type === 'product' ? 'collection' : 'archive')}`;

            const renderDetails = () => {
                const details = [ { label: 'category', value: item.category }, { label: 'year', value: item.year }, { label: 'color', value: item.color }, { label: 'size', value: item.size }, { label: 'condition', value: item.condition }, { label: 'material', value: item.material }, { label: 'author', value: item.author }, { label: 'publisher', value: item.publisher }];
                return details.filter(d => d.value).map(d => 
                    e('div', { key: d.label, className: 'flex justify-between text-sm py-2 border-b' },
                        e('span', { className: 'font-martian-mono text-cold-gray uppercase' }, d.label),
                        e('span', { className: 'font-martian-mono capitalize' }, d.value)
                    )
                );
            };

            const renderMeasurements = () => {
                if (!item.measurements || Object.keys(item.measurements).length === 0) return null;
                return e('div', { className: 'mt-4' },
                    e('h4', { className: 'font-martian-mono text-sm uppercase font-bold my-2' }, 'Measurements'),
                    Object.entries(item.measurements).map(([key, value]) => 
                        e('div', { key: key, className: 'flex justify-between text-sm py-2 border-b' },
                            e('span', { className: 'font-martian-mono text-cold-gray capitalize' }, key),
                            e('span', { className: 'font-martian-mono' }, value)
                        )
                    )
                );
            };

            const renderActionButtons = () => {
                const buttons = [];
                if(item.type === 'archive' || item.type === 'book'){
                    buttons.push(e('button', { key: 'inquiry', onClick: () => setModal('inquiry'), className: 'w-full bg-black text-white py-3 font-martian-mono uppercase tracking-wider text-sm hover:bg-dark-gray transition-colors' }, 'Contact for Inquiry'));
                }
                if(item.type === 'product'){
                     buttons.push(e('button', { key: 'inquiry', onClick: () => setModal('inquiry'), className: 'w-full border border-black text-black py-3 font-martian-mono uppercase tracking-wider text-sm hover:bg-gray-100 transition-colors' }, 'Contact for Inquiry'));
                     buttons.push(e('button', { key: 'platforms', onClick: () => setModal('platforms'), className: 'w-full bg-black text-white py-3 font-martian-mono uppercase tracking-wider text-sm hover:bg-dark-gray transition-colors' }, 'Available On Platforms'));
                }
                return e('div', { className: 'mt-6 space-y-2' }, ...buttons);
            };

            return e(Fragment, null,
                e('main', { className: 'container mx-auto px-4 sm:px-6 lg:px-8 py-8' },
                    e('a', { 
                        href: goBackUrl, 
                        onClick: (ev) => { ev.preventDefault(); navigateTo(goBackUrl); },
                        className: 'flex items-center gap-2 font-martian-mono text-sm uppercase text-cold-gray hover:text-black mb-6' 
                    }, e(Icon, { name: 'ArrowLeft', size: 16 }), 'Back'),
                    e('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-12' },
                        e('div', { className: 'flex flex-col-reverse lg:flex-row gap-4' },
                            e('div', { className: 'flex lg:flex-col gap-2 flex-wrap' },
                                item.images.map((img, index) => e('img', { 
                                  key: index, src: img, alt: `Thumbnail ${index+1}`, onClick: () => setMainImage(img),
                                  className: `w-16 h-20 object-cover cursor-pointer bg-gray-100 ${mainImage === img ? 'outline outline-2 outline-black' : ''}`
                                }))
                            ),
                             e('div', { className: 'flex-1 aspect-[4/5] bg-gray-100' },
                                e('img', { src: mainImage, alt: item.name, className: 'w-full h-full object-cover' })
                            )
                        ),
                        e('div', { className: 'sticky top-24 self-start' },
                            e('h2', { className: 'font-martian-mono text-2xl font-bold uppercase' }, item.brand || item.author),
                            e('h1', { className: 'font-martian-mono text-xl mt-1' }, item.name),
                            e('p', { className: 'font-martian-mono text-sm mt-4 leading-relaxed' }, item.description),
                            e('div', { className: 'mt-6' }, renderDetails()),
                            renderMeasurements(),
                            renderActionButtons()
                        )
                    )
                ),
                e(Modal, { isOpen: modal === 'inquiry', onClose: () => setModal(null), title: 'Product Inquiry' }, e(InquiryForm)),
                e(Modal, { isOpen: modal === 'platforms', onClose: () => setModal(null), title: 'Available On' },
                    e('div', { className: 'space-y-2' },
                        Object.entries(item.purchaseLinks || {}).map(([platform, url]) => 
                            e('a', {
                                key: platform, href: url, target: '_blank', rel: 'noopener noreferrer',
                                className: 'flex items-center justify-between w-full bg-gray-100 hover:bg-gray-200 p-4 font-martian-mono uppercase text-sm transition-colors'
                            }, e('span', null, platform), e(Icon, { name: 'ExternalLink', size: 16 }))
                        )
                    )
                )
            );
        };
        
        const ContactPage = () => {
            const FormInput = ({ id, label, type = 'text', placeholder }) => e('div', { className: 'mb-4' },
                e('label', { htmlFor: id, className: 'block font-martian-mono text-xs uppercase mb-1' }, e('span', null, label, e('span', {className: 'text-red-500'}, '*'))),
                e('input', { type, id, name: id, required: true, placeholder, className: 'w-full border border-black p-2 text-sm focus:outline-none focus:ring-1 focus:ring-black font-martian-mono' })
            );

            const FormTextarea = ({ id, label, placeholder }) => e('div', { className: 'mb-4' },
                e('label', { htmlFor: id, className: 'block font-martian-mono text-xs uppercase mb-1' }, e('span', null, label, e('span', {className: 'text-red-500'}, '*'))),
                e('textarea', { id, name: id, required: true, rows: 4, placeholder, className: 'w-full border border-black p-2 text-sm focus:outline-none focus:ring-1 focus:ring-black font-martian-mono' })
            );

            const FormSelect = ({ id, label, children }) => e('div', { className: 'mb-4' },
                 e('label', { htmlFor: id, className: 'block font-martian-mono text-xs uppercase mb-1' }, e('span', null, label, e('span', {className: 'text-red-500'}, '*'))),
                 e('select', {id, name: id, required: true, className: 'w-full border border-black p-2 text-sm focus:outline-none focus:ring-1 focus:ring-black bg-white font-martian-mono'}, children)
            );

            return e('main', { className: 'container mx-auto px-4 sm:px-6 lg:px-8 py-12' },
                 e('h2', { className: 'font-martian-mono uppercase font-bold text-xl mb-1' }, 'Contact'),
                 e('p', { className: 'font-martian-mono text-sm text-cold-gray mb-10' }, 'questions about a specific piece?...'),
                e('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-12' },
                    e('div', null,
                        e('h3', { className: 'font-martian-mono text-lg font-bold uppercase mb-4' }, 'Send a message'),
                        e('form', null,
                            e(FormInput, { id: 'name', label: 'Name', placeholder: 'your full name' }),
                            e(FormInput, { id: 'email', label: 'Email', type: 'email', placeholder: 'your.email@example.com' }),
                            e(FormSelect, { id: 'subject', label: 'Subject' },
                                e('option', { value: '' }, 'select message subject'),
                                e('option', { value: 'inquiry' }, 'product inquiry'),
                                e('option', { value: 'research' }, 'research request'),
                                e('option', { value: 'other' }, 'other')
                            ),
                            e(FormTextarea, { id: 'message', label: 'Message', placeholder: 'write your message here…' }),
                            e('button', { type: 'submit', className: 'w-full bg-black text-white py-3 font-martian-mono uppercase tracking-wider text-sm font-bold hover:bg-dark-gray transition-colors' }, 'Send Message')
                        )
                    ),
                    e('div', null,
                         e('h3', { className: 'font-martian-mono text-lg font-bold uppercase mb-4' }, 'Get in touch'),
                        e('div', { className: 'mb-8' },
                            e('p', { className: 'font-martian-mono text-sm' }, e('a', { href: 'mailto:gdarchivio0@gmail.com', className: 'underline' }, 'gdarchivio0@gmail.com')),
                        ),
                        e('div', { className: 'mb-8' },
                           e('h4', { className: 'font-martian-mono uppercase font-bold text-sm mb-2' }, 'Follow Us'),
                           e('a', {href: 'https://instagram.com', target: '_blank', rel: 'noopener noreferrer', className: 'flex items-center gap-2 text-sm font-martian-mono'}, e(Icon, {name: 'Instagram'}), 'Instagram')
                        ),
                        e('div', null,
                            e('h4', { className: 'font-martian-mono uppercase font-bold text-sm mb-4' }, 'Frequently Asked'),
                            e('div', { className: 'space-y-4' },
                                e('div', null,
                                  e('p', { className: 'font-martian-mono text-sm font-bold' }, 'IS THIS AN ONLINE ARCHIVE ONLY?'),
                                  e('p', { className: 'font-martian-mono text-sm mt-1 text-dark-gray' }, 'yes, gdarchivio operates as a digital fashion archive. Consultations and viewing can be arranged by appointment.')
                                ),
                                e('div', null,
                                  e('p', { className: 'font-martian-mono text-sm font-bold' }, 'CAN I CONTRIBUTE TO THE ARCHIVE?'),
                                  e('p', { className: 'font-martian-mono text-sm mt-1 text-dark-gray' }, 'we welcome contributions from collectors and fashion enthusiasts. Contact us to discuss adding pieces to our archive.')
                                )
                            )
                        )
                    )
                )
            );
        };

        // ==========================================================
        // APPLICAZIONE PRINCIPALE E ROUTING
        // ==========================================================
        const App = () => {
            const [route, setRoute] = useState(window.location.hash || '#home');

            useEffect(() => {
                const handleHashChange = () => {
                    setRoute(window.location.hash || '#home');
                    window.scrollTo(0, 0);
                };
                window.addEventListener('hashchange', handleHashChange);
                handleHashChange();
                return () => window.removeEventListener('hashchange', handleHashChange);
            }, []);
            
            const navigateTo = useCallback((path, item = null) => {
                const newRoute = item ? `${path}/${item.id}` : path;
                if (window.location.hash !== newRoute) {
                  window.history.pushState(null, '', newRoute);
                }
                setRoute(newRoute);
                window.scrollTo(0, 0);
            }, []);

            const renderPage = () => {
                const [page, id] = route.substring(1).split('/');
                const allItems = [...mockProducts, ...mockLibraryItems];
                const item = allItems.find(p => p.id === id);

                switch (page) {
                    case 'collection':
                        return id ? e(DetailPage, { item, navigateTo }) : e(ListPage, { items: mockProducts.filter(p => p.type === 'product'), navigateTo, page: '#collection', options: filterOptions.collection });
                    case 'archive':
                        return id ? e(DetailPage, { item, navigateTo }) : e(ListPage, { items: mockProducts.filter(p => p.type === 'archive'), navigateTo, page: '#archive', options: filterOptions.archive });
                    case 'library':
                        return id ? e(DetailPage, { item, navigateTo }) : e(ListPage, { items: mockLibraryItems, navigateTo, page: '#library', options: filterOptions.library });
                    case 'contact':
                        return e(ContactPage, { navigateTo });
                    case 'home':
                    default:
                        return e(HomePage, { navigateTo });
                }
            };
            
            const isHomePage = route === '#home' || route === '';

            return e('div', { key: route, className: 'animate-fade-in' },
                !isHomePage && e(Header, { navigateTo, currentRoute: route }),
                renderPage(),
                !isHomePage && e(Footer)
            );
        };
        
        // --- Avvio dell'applicazione ---
        const rootElement = document.getElementById('root');
        if (rootElement) {
            createRoot(rootElement).render(e(App));
        } else {
            console.error("L'elemento 'root' non è stato trovato nel DOM.");
        }
    }
    </script>
</body>
</html>